local aa=require("basaltLoader") local ba=aa.load("VisualElement")local ca=aa.load("List")local da=require("utils").tHex local _b=setmetatable({},ca)_b.__index=_b;_b:initialize("Menubar") _b:addProperty("spacing","number",1) function _b:new(ab,bb,cb)local db=ca:new(ab,bb,cb)setmetatable(db,self) self.__index=self;db:setType("Menubar")db:create("Menubar") db:setSize(20,1)return db end function _b:mouse_click(ab,bb,cb) if(ba.mouse_click(self,ab,bb,cb))then if(ab==1)then local db=self.x for i=self.scrollIndex,#self.items do local _c=#self.items[i]+self.spacing;if bb>=db and bb<db+_c then self.selectedIndex=i self:fireEvent("change",self.items[i])break end;db=db+_c end end;return true end end function _b:render()ba.render(self)local ab=self.scrollIndex;local bb=1 self:addText(1,1,(" "):rep(self.width)) self:addBg(1,1,da[self.background]:rep(self.width)) self:addFg(1,1,da[self.foreground]:rep(self.width)) while bb<=self.width and ab<=#self.items do local cb=self.items[ab] if bb+#cb-1 +self.spacing<=self.width then self:addText(bb,1,cb)if ab==self.selectedIndex then self:addBg(bb,1,da[self.selectionBackground]:rep( #cb)) self:addFg(bb,1,da[self.selectionForeground]:rep(#cb))end;bb=bb+ #cb+self.spacing else break end;ab=ab+1 end end function _b:mouse_scroll(ab,bb,cb) if(ba.mouse_scroll(self,ab,bb,cb))then if ab==1 and self.scrollIndex<#self.items- self:getVisibleItems()+1 then self.scrollIndex=self.scrollIndex+1 elseif ab==-1 and self.scrollIndex>1 then self.scrollIndex=self.scrollIndex-1 end;self:updateRender()return true end end function _b:getVisibleItems()local ab=0;local bb=self.scrollIndex;local cb=1 while cb<=self.width and bb<=#self.items do local db=self.items[bb] if cb+#db-1 +self.spacing<= self.width then ab=ab+1;cb=cb+#db+self.spacing else if cb+#db-1 <= self.width then ab=ab+1 end;break end;bb=bb+1 end;return ab end;return _b